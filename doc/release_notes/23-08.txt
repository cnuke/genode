

              ===============================================
              Release notes for the Genode OS Framework 23.08
              ===============================================

                               Genode Labs



; intro
; @nfeske



Multi-component debug monitor
#############################

The existing GDB monitor has a number of limitations that we need to overcome
to make on-target debugging a regular feature of Genode and Sculpt OS.

The most visible problems are:

* The GDB monitor supports only one component as debugging target, which makes
  the debugging of scenarios where components closely interact difficult.

* The existing implementation re-uses the gdbserver code and thereby inherits
  many POSIX peculiarities that must be stubbed for Genode, yet make the
  overall implementation complex.

Given these limitations, two key ideas motivated a new approach for the
revision of Genode's GDB support for this release:

First, by using Genode's sandbox API as foundation for a new debug monitor,
we would become able to use the monitor as drop-in replacement for 'init',
potentially going as far as using the monitor for Sculpt's runtime subsystem.

And second, GDB supports the debugging of multiple processes (called inferiors)
within one session, which would in principle allow us to inspect and debug
component compositions.

The result of these ideas is the new 'monitor' component at 'os/src/monitor'
as the designated successor of the 'gdb_monitor'. By leveraging the sandbox API
it can be used as a drop-in replacement for the 'init' component and monitor
multiple components. In real-world scenarios like Sculpt's runtime, we
deliberately want/need to restrict the debugging to a few selected components,
however, which calls for the support of a mix of monitored and regular
components hosted side by side. Given this requirement, the sandbox API had to
be enhanced to support the selective interception of PD and CPU sessions.

Like the 'gdb_monitor', the new monitor speaks the GDB remote serial protocol
over Genode's terminal session. But the protocol implementation does not re-use
any gdbserver code, sidestepping the complexities of POSIX.

The monitor supports the essential GDB remote protocol commands for reading and
writing of memory and registers, for stopping and resuming of threads including
single-stepping, and it reports the occurrence of page faults and exceptions to
GDB. Breakpoints are managed by GDB using software breakpoint instructions.

The monitor operates in GDB's 'non-stop' mode, which means that threads of
multiple inferiors can be stopped and resumed individually or in groups,
depending on the GDB commands issued by the user.

As a secondary functionality, the monitor wipes all RAM dataspaces allocated
by the monitored components when the RAM is freed. This is useful as a possible
defense against cold-boot attacks.

Supported debugging target platforms as of now are NOVA/x86_64, hw/x86_64 and
hw/arm_64.

For the hw platforms, we extended the low-level debugging support in the hw
kernel as needed and the hw/arm_64 support also required a change in Genode's
customized GDB port to enable shared library support for this architecture.
So, in order to use Genode's host GDB with the monitor on hw/arm_64, the Genode
tool chain needs to be rebuilt with the 'tool/tool_chain' script. Rebuilding
GDB also fixes a potential failed assertion in GDB if at least two threads are
initially stopped when GDB connects to the monitor.

There exist three run scripts illustrating the new component. The
'os/run/monitor.run' script exercises memory inspection via the 'm' command
and memory modification via the 'M' command by letting a test program monitor
itself. The 'os/run/monitor_gdb.run' script performs automated tests of various
GDB commands and the 'os/run/monitor_gdb_interactive.run' script allows for the
interactive use of GDB to interact with monitored components.

There's also a 'README' file in the 'os/src/monitor' directory with more
details regarding the configuration of the monitor component.


Streamlined application development via Goa
###########################################

; Find a better section title to distinguish from previous release?

; @jschlatow


Base framework and OS-level infrastructure
##########################################

Internal core and base-framework modernization
==============================================

; @nfeske

commit f47c64e246ce68bd26893ded53e5b19332f497d1
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Thu May 25 16:49:13 2023 +0200

    core: allow offset-attached managed dataspaces
    
    This patch adds the missing application of the region offset to the
    resolution of page faults inside managed dataspaces, which resulted in
    an unexpected "invalid mapping" message after attaching a managed
    dataspace with an offset.
    
    This limitation could be observed during the implementation of the debug
    monitor that locally maps a portion of the debugging target's address
    space, e.g., a view port of 16 MiB. All traditional uses of managed
    dataspaces (e.g., stack area, linker area) happened to attach the
    managed dataspaces from their beginning.
    
    Issue #4917

commit 30b70da6c1278e3ece8c566f352ab8c092eaedc0
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed May 10 11:39:15 2023 +0200

    base/child.h: Child_policy::with_address_space
    
    This patch replaces the former 'address_space' accessor by a new
    'with_address_space' interface that grants access to the region map of
    the child's address space, but limits the interface lifetime to the
    scope of the caller.
    
    Issue #4917

commit a4c59c03e31d846c966d8a5f7e8e3a4acd355b90
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Fri Jun 9 18:08:47 2023 +0200

    core: rework page-fault resolution
    
    The change "core: allow offset-attached managed dataspaces" addressed a
    corner case of the use of nested region maps. Apparently, this change
    negatively affects other scenarios (tool_chain_auto).
    
    In order to confidently cover all the differnt situations, this patch
    reworks the page-fault resolution code for improved clarity and safety,
    by introducing dedicated result types, reducing the use of basic types,
    choosing expressive names, and fostering constness.
    
    It also introduces a number of 'print' hooks that greatly ease manual
    instrumentation and streamlines the error messages printed by core.
    Those messages no longer appear when a user-level page-fault handler
    is reistered for the faulted-at region map. So the monitor component
    produces less noise on the attempt to dump non-existing memory.
    
    Issue #4917
    Fixes #4920

commit 3c5d27506f216e38108d81ff07b0a12c25f773aa
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Sat Jun 10 01:12:30 2023 +0200

    base: stricter distinction between rx and rwx
    
    This patch restricts 'Region_map::attach_executable' to create read-only
    mappings, while offering the option to map the full rights using a new
    'attach_rwx' method.
    
    The 'attach_rwx' method is now used by the dynamic linker to explicitly
    attach the linker area with full rwx rights. With the old page-fault
    handling code, the execute flag was evaluated only for leaf dataspaces,
    not for managed dataspaces while traversing region-map hierarchies.
    With the new page-fault handling code, the execute bit is downgraded
    to no-execute when passing a managed dataspace that is not attached
    as executable.
    
    Issue #4920

commit 3489672bc00d006f0e5185385dcdf855ddebf082
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Tue Jun 20 13:45:33 2023 +0200

    base: remove env_deprecated from thread-start code
    
    This patch replaces the internal use 'env_deprecated()' from the
    implementation of the thread API in the base library. It also
    replaces the global accessor 'main_thread_cap' by the explicit
    propagation of the main-thread's capability to the single point of
    use via a new 'init_thread_bootstap' function.
    
    Issue #4784

commit 6e30d00eefe0bf70e45ce2b1b4271b16468b7e9d
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Tue Jun 20 14:46:54 2023 +0200

    base: remove env_deprecated from signalling code
    
    Issue #4784

commit 0ab69a2bb835d242a4bb07e2294b28f04eb59a32
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Tue Jun 20 17:53:41 2023 +0200

    base: de-duplicate src/lib/base/platform.cc
    
    By splitting the 'init_capability_slab()' implementation to a separate
    compilation unit 'capability_slab.cc', base-hw no longer needs a
    customized version of 'lib/base/platform.cc'.
    
    Related to issue #4784

commit 415d4ab23d0935d44be7e499a61694716292c1c1
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 21 17:08:42 2023 +0200

    startup: merge init_main_thread.cc into _main.cc
    
    This makes the interplay of 'init_main_thread', 'init_platform',
    '_main', and 'bootstrap_component' easier to follow.
    
    Issue #4784

commit de99945af05f182aed86d67768c63c8cd88ab84a
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 21 17:25:44 2023 +0200

    base: pass 'Platform &' to 'bootstrap_component'
    
    This eliminates the need of component.cc to pull the platform resources
    out of thin air (calling 'env_deprecated()').
    
    Issue #4784

commit 7e1a2ac684b94e4ab79306c2e6315dd75310b8ac
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 21 17:51:04 2023 +0200

    base: remove internal use of 'env_deprecated'
    
    Fixes #4784

commit e2836bf68a009906a2468ea03c58109dda9336a0
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 28 14:27:34 2023 +0200

    ldso: remove deprecated support for legacy 'main'
    
    Besides the removal of the legacy 'main' support, this patch simplifies
    the lib/startup/_main.cc.
    
    Issue #2199

commit 1fd1786122ca735841535ed53c07d8354c1998b7
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 28 15:46:04 2023 +0200

    test/lx_hybrid: don't call glibc exit
    
    This patch removes the use of the Entrypoint::schedule_suspend mechanism
    and the call of glibc's exit from the lx_hybrid tests, for two reasons.
    
    First, the interplay of atexit handlers executed by the glibc and
    Genode's lx_hybrid library is complicated while bringing no benefits in
    practice as lx_hybrid applications are usually servers that don't exit
    anyway.
    
    Second, the Entrypoint::schedule_suspend mechanism in not used by any
    other component. By removing its use from the lx_hybrid tests, we can
    remove this mechanism from the base library.
    
    Issue #4940

commit 1139492c4f53b1612647070459eaa98284270098
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Wed Jun 28 15:57:45 2023 +0200

    base: remove Entrypoint::schedule_suspend
    
    Fixes #4940


API changes
===========

; @nfeske

Register framework update
-------------------------

commit c907e44a024c31b338f72158d02fb0f7c7a0a84d
Author: Martin Stein <martin.stein@genode-labs.com>
Date:   Wed Jun 7 19:14:04 2023 +0200

    register framework: read bitfields to fitting uint
    
    * Replaces bool access types with uint8_t access types
    * Ensures, that the framework always uses the smalles possible uint type
      for the return value wherever a bitfield is read and returned to the user.
    
    Ref #4924

commit bf18ffbbdda6c05e16efdc643be3780cce07aefb
Author: Martin Stein <martin.stein@genode-labs.com>
Date:   Tue Jun 13 14:32:35 2023 +0200

    lib/net: enable strict warnings
    
    Enables strict warnings in the net lib and fixes all related compile errors.
    
    Fixes #4924


Hex-dump utility
----------------

commit 8bad3d08d70b9284e53b7ca25a3783ace13390bf
Author: Martin Stein <martin.stein@genode-labs.com>
Date:   Thu Jul 20 15:29:42 2023 +0200

    util/formatted_output.h: hex-dump utility
    
    Adds Genode::Hex_dump class to the formatted_output.h header. This class can be
    used to print a hexadecimal dump of a byte range. The data is printed in a
    format similar to that used by Linux's 'xxd'. In addition to the 'xxd' format,
    consecutive duplicate lines are replaced with a single "*\n" as done also by
    Linux's 'hexdump'.
    
    Ref #4966


Libraries and applications
##########################

New NIC server for raw uplink connectivity
==========================================

With Genode 21.02, we transitioned all network device drivers to act as session
clients in order to make them pluggable. We achieved this by introducing a new
service named Uplink that is very similar to the Nic service but with the peer
roles switched. Up to now, the only Uplink server and Uplink-to-Nic adapter was
the NIC router. This is reasonable as it is the standard network multiplexer in
Genode and therefore normally sits in front of each network device driver
anyway. However, there is one major issue with this approach: It binds physical
network access to layer 3 and 4 routing respectively layer 2 multiplexing,
which, in our case, means that Nic clients can talk to the physical network
only with what is protocol-wise supported by the NIC router.

That's why Genode 23.08 introduces the new Nic-Uplink adapter component. It
re-enables raw access to physical networks in Genode by forwarding packets
unmodified and unfiltered between multiple Nic sessions and one Uplink session.
The new component is accompanied by a test script nic_uplink.run that
demonstrates the low-level integration and a Sculpt package pkg/pc_nic that can
be used for deployment in more sophisticated systems together with the PC
NIC-driver as back end.

One constellation in which the Nic-Uplink server will be especially useful for
us is the planned enablement of IPv6 on different layers of Genodes network
stack. More specifically, the tool will allow us to work at IPv6 support in
both Genodes ported TCP/IP stacks and the NIC router at the same time.


New depot-remove component
==========================

_The work described in this section was contributed by Alice Domage._
_Thanks for this welcome addition._

Genode's on-target package management allows for the installation of multiple
versions of the same package side by side, which is useful to roll
back the system to an earlier state, or to accommodate software depending on
an older library version. Software is installed into the so-called _depot_
stored on the target and populated with downloads on demand. Until now,
however, the on-target depot could only grow, not shrink. Even though this
limitation hasn't been a pressing concern for Sculpt OS on the PC, it impeded
embedded use cases.

The new depot-remove component lifts this limitation by providing an
orderly way to remove depot content and orphaned dependencies.
It operates by reading its configuration and
processes delete operations based on the provided rules.
A typical configuration looks as follows.

! <config arch="x86_64" report="yes">
!     <remove user="alice" pkg="nano3d"/>
!     <remove user="bob"   pkg="wm" version="2042-42-42"/>
!     <remove-all>
!         <keep user="alice" pkg="fonts_fs"/>
!     </remove-all>
! </config>

For more details about the configuration options, please refer to the README
file at _/gems/src/app/depot_remove/_. Furthermore, the
_gems/run/depot_remove.run_ script illustrates the component by exercising
several practical use cases.


DDE-Linux changes
=================

; @cnuke

commit caac994da848bcafe1425e0aaeca3fd677953fff
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Jun 15 12:57:03 2023 +0200

    lx_kit: decouple schedule execution
    
    Prior to this commit, whenever an external event occurred, for example
    timer or interrupt, the corresponding I/O signal handler was triggered.
    This handler unblocked the task waiting for the event and initiated the
    immediate execution of all unblocked tasks. Since these tasks may hit
    serialization points, e.g. synchronously waiting for packet stream
    operations, that require handling of other I/O signals this leads to
    nested execution. This, however, is not supported and mixes application
    and I/O level signal handling.
    
    The flagging of the scheduling intent is now decoupled from its
    execution by using an application level signal handler that is run in
    the context of the components main entrypoint. The I/O signal handler
    now triggers the scheduling execution by sending a local signal to
    the EP.
    
    Since it might be necessary to execute a pending schedule from the EP
    directly the scheduler is extended with the 'execute' member function
    that performs the check that the scheduler is called from within the
    EP and triggers the execution afterwards.
    
    Issue #4927.

commit 1cac1340301e722025c29e888b0e417c06dc725c
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Tue Jun 20 16:17:19 2023 +0200

    lx_kit: support multiple pending IRQs
    
    Decoupling the scheduler execution can lead to missed interrupts
    because the current implementation only handles one pending
    interrupt and requires immediate processing.
    
    This commit introduces a helper object that is used to capture
    any occuring interrupts that are then handled consecutively.
    
    Issue #4927.

commit e18c02991e5239f19ad92e7787d96a109888e062
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Jul 6 13:02:04 2023 +0200

    lx_kit: use central signal handler for scheduling
    
    This commit extends the Lx_kit initialization function by passing in
    a signal handler that is used to perform the normally occurring
    scheduler execution and is a follow-up change for the decoupling
    scheduler execution commit.
    
    Instead of burying the signal handler in the 'Lx_kit::Scheduler'
    object it is provided by the main object where the driver is free
    to perform any additional step before or after executing the scheduler.
    
    Issue #4927
    Fixes #4952


Tresor block encryptor
======================

We further polished the Tresor Tester in order to make it run on a broad
spectrum of target platforms. For instance, the test can now be run without
entropy input (permanently warning the user about the security risk) because
some of our test hardware lacks support for it. Besides that, we mainly worked
at the resource consumption of the test - made it more adaptable or reduced it
through improvements. This pleased not only less powerful hardware but our test
management as well.

Furthermore, we fixed a significant former deficiency with the Tresor library.
The library used to work on the raw on-disc data without decoding first. This
worked fine for some platforms but caused alignment faults on others. That
said, the Tresor library now always decodes into naturally typed and aligned
C++ structs before accessing the data. The speed-up of accessing decoded data
seems to compensate for the decoding effort because we did not observe a
significant performance regression.

Device drivers
##############

Intel GPU
=========

@ssumpf

commit e3c2fdf414135aa9e8f84b7767ca0c3d7a0c7098
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Mon May 22 21:57:22 2023 +0200

    gpu/intel: enable GPU reset for GEN(8)/9/12
    
    * add semaphore command to ring in order to be able to stop ring
      execution before reset (Wa KabyLake)
    * implement reset sequence as done by the Linux driver
    * reset ring and cancel job of vgpu causing hang
    * lower watchdog timeout 1000ms -> 200ms
    * improve scheduling of vgpus so progress after reset is made
    * improve the generation chaos a little
    * tested on Skylake, Kaby Lake, Tiger Lake
    
    issue #4916


Intel display
=============

The ported Linux Intel display driver now supports USB Type-C connectors as
used with modern notebooks.

New PC network driver based on DDE-Linux
========================================

Since 2010, we use Ethernet drivers ported from the iPXE project in a tiny
emulation layer on Genode. While those drivers did a good job for the common
cases, they always had some rough edges that may not hurt in the original
network-booting use case but had become a nuisance in Sculpt OS and Genode
in general. Most prominently the dropped link speed with Intel E1000e cards
on cable unplug/plug and the moderate throughput on GBit links had to be
addressed.

Our new DDE Linux approach introduced this year makes the porting of drivers
from the Linux kernel much easier and less labor intensive as in the past.
Also, Linux is a very tempting Ethernet driver donor because of the variety
of supported devices and the well known excellent performance (especially on
Intel devices). Moreover, the Intel E1000e driver addresses all issues we
had with the iPXE implementation and promises a smooth interplay with Intel
AMT/ME. Note, Intel AMT Serial-over-LAN is still an important debug console
while deploying Genode on Intel-based notebooks.

Hence, the current release brings the new _pc_nic_drv_ for Intel
e1000/e1000e, Realtek 8169, and AMD PCnet32 (Qemu) devices on PC and is
fully integrated into Sculpt OS. Performance-wise the driver easily
saturates 1 GBit links in our throughput tests.


USB host controller
===================

The USB host controller driver ports for Raspberry Pi 1 and i.MX 6 Quad got
updated to Linux kernel version 6.1.37 resp. 6.1.20. Both driver ports share the
renewed device driver environment approach for Linux introduced in release 21.08.

Beside the update of the last remaining outdated USB host controller drivers, we
have reworked the common C/C++ Linux to Genode USB backend used by all USB
host controller driver incarnations. The internal changes were necessary to
target issues regarding races during USB session close attempts, resets
of USB endpoints, and potential stalls during synchronous USB RPC calls.

PC audio refinements
====================

; @cnuke

commit ff0ba89e917d5adf3aa072f3d3ebca80da966780
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Apr 28 11:21:56 2023 +0200

    dde_bsd: update mixer state report on HP sense
    
    Issue #4946.

commit 317c5429d21e78dc9cf8bb5a8b78a2357b943b64
Author: Josef Söntgen <jws@sysret.de>
Date:   Thu Jun 22 20:42:41 2023 +0000

    dde_bsd: decrease overall memory consumption
    
    The initial memory backend implementation was brought over from DDE
    Linux and was geared towards use-cases where a high-performing
    allocator is useful. In case of the audio driver this is overkill
    and since no other driver that could benefit from such an
    implementation was ported in the meantime rather use a simpler
    implementation that keeps the overhead down.
    
    Fixes #4946.

commit 93d6d71a1de0bf56e866524780053dcb28aecb5f
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Tue Jul 11 11:30:42 2023 +0200

    dde_bsd: add patch to limit internal buffer size
    
    Decreasing the internal buffer size will implicitly limit the number
    of blocks provisioned for recording and brings them in line with
    the number of blocks used for playback (2).
    
    Note that this patch also sets an upper-bound on the number of
    samples in 'Audio_*::PERIOD'.


Wifi
====

; @cnuke

commit fc24ffcdb823c47b240385bed0ec0c96e3f1f177
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Jul 6 16:25:41 2023 +0200

    wifi: use mac address reporter
    
    Remove the handcrafted MAC address reporter in favour the Genode
    C API utility (cf. #4918).
    
    Issue #4927
    Issue #4918

commit dd1b8a106fd9ef5388da8d03af15a3bcfa4ba0b2
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Jul 7 11:46:39 2023 +0200

    drivers/wifi: perform multi-staged construction
    
    Since the wireless LAN driver is actually a 'Libc::Component' due to
    its incorporation of the 'wpa_spplicant' application, we have to
    intercept its construction because we have to initialize the Lx_kit
    environment before any static ctors are executed. Most Linux initcalls
    are implemented as ctors that will be otherwise implicitly executed
    before the controll is given to us in 'Libc::Component::construct'.
    
    Issue #4927.


PinePhone support for buttons and screensaver
=============================================

To equip the mobile version of Sculpt OS on the PinePhone with a proper
screensaver, we added drivers for detecting user interactions with the
PinePhone's physical buttons, namely the volume buttons and the power button.

The volume buttons are connected via cascaded resistors to a single ADC of the
A64 SoC. The corresponding driver has been added to the genode-allwinner
repository at _src/drivers/button/pinephone/_ and is accompanied by the
_button_pinephone.run_ script.

Sensing the power button has been a slightly more delicate issue because the
power button is connected to the power-management IC (PMIC), which shall only
be accessed via the system-control processor (SCP). To detect state changes,
the PMIC's IRQ (routed through the R_INTC to the GIC) is now handled by the
power driver. This has the added benefit that also other interesting PMIC
events (like connecting AC) get immediately reported.

With the button drivers in place, we finally equipped Sculpt OS with a
screensaver as a crucial battery-conserving feature. The screensaver
kicks in after the user remained inactive in the administrative user interface
for some time. It also can be manually activated by pressing the power button.
While the screen is blanked, a press of the power button enables the display
again.

Under the hood, Sculpt completely removes the drivers for the display and the
touchscreen while the screen is blanked, which considerably reduces the power
draw. The system also switches the CPU to economic mode while the screen is
blanked. Here are some illustrative data points:

!    Max brightness in performance mode: 2.8 W
!    Max brightness in economic mode:    2.6 W
!    Low brightness in economic mode:    1.7 W
!    Screensaver:                        1.1 W

You can find the screensaver feature integrated in the latest Sculpt OS
image published by _nfeske_.


Platforms
#########

NXP i.MX SoC family
===================

Certain parts of i.MX specific code, like the base-support for the hw-kernel,
and the GPIO driver for i.MX got moved from Genode's main repository to the
corresponding genode-imx repository.

Sculpt OS image creation for MNT Reform2
----------------------------------------

With this release we introduce mainline support for Sculpt OS on the MNT
Reform2. To build a Sculpt OS image for this board you can use the common
sculpt_image.run script, like the following:

! make run/sculpt_image KERNEL=hw BOARD=mnt_reform2 DEPOT=omit

To be effective you need to extend your RUN_OPT variable accordingly:

! RUN_OPT += --include image/imx8mq_mmc

seL4 microkernel
================

With the update of the seL4 kernel in the previous release we now added several
improvements which shorten the boot-up-time of Genode's 'core'
roottask on seL4 by converting untyped memory to I/O memory on demand.

Build system and tools
######################

Depot autopilot on-target test orchestrator
===========================================

As the rough plan to support automated testing in Goa is shaping up, it makes
sense to share one convention about expressing the success criteria for a
package under test between the Depot Autopilot and Goa. This merge motivated
us to review the convention that was used with the Depot Autopilot up until
now. The old syntax looked as follows:
```
<runtime ...>
  <events>
    <timeout meaning="failed" sec="20"/>
    <log meaning="succeeded">
      [init -> rom_logger] ROM 'generated':*
      [init -> dynamic_rom] xray: change (finished)
    </log>
    <log meaning="succeeded">child exited</log>
    <log meaning="failed">Error: </log>
  </events>
  ...
</runtime>
```

We found that we wanted to apply various simplifications to this syntax:
* Drop the intermediate <events> tag.
* Replace <log meaning="succeeded"> by <succeed>.
* Replace <log meaning="failed"> by <fail>.
* Replace <timeout meaning="failed" sec="20"/> by an after_seconds
  attribute of the <success> or <fail> tags.

So, the above example would become the following:
```
<runtime ...>
  <fail after_seconds="20"/>
  <succeed>
    [init -> rom_logger] ROM 'generated':*
    [init -> dynamic_rom] xray: change (finished)
  </succeed>
  <succeed>child exited</succeed>
  <fail>Error: </fail>
  ...
</runtime>
```

Genode 23.08 adds support for this new scheme to the Depot Autopilot but keeps
backwards-compatibility for now in order to allow Genode users to adapt to the
change progressively. The Depot Autopilot always looks out for an <event> tag:
If the tag is present in a package runtime, the old scheme is being used.
Otherwise, the new one. Note that backwards-compatibility is planned to be
removed after a short transition period.

All test packages of the official Genode repositories have already been updated
to the new convention. From this experience, we can tell that automation via a
combination of xslt script and sed commands can be worth the effort if you're
maintaining a considerable number of test packages.

Furthermore, we took the opportunity to also add a new feature. The optional
'log_prefix' attribute in the <succeed> and <fail> tags is a simple but handy
white-list filter when it comes to typical Genode logs. When matching the test
log against the pattern given in the affected <succeed> or <fail> tag, the
Depot Autopilot will consider only those log lines that start with the given
prefix. This is an easy way to watch only specific Genode components and solve
problems with the log order of simultaneously running components.

Last but not least, the transition prompted us to fix a minor issue with the
Depot Autopilot log-processing. Color sequences will now be forwarded correctly
from the test runtime to the log output of the Depot Autopilot, making the
analysis of test batteries a more pleasant experience.

Updated run-tool defaults for x86_64
====================================

With the update of the seL4 kernel and the update of the toolchain to GNU GCC
12 in the previous release, x86 assembly instructions are generated,
like POPCNT, which are not supported anymore by the Qemu CPU models we used.
Previously, depending on the used kernel, either

* the default CPU model or
* -cpu core2duo for Genode@NOVA or
* -cpu phenom for SVM virtualization

was used. Because of that we changed with this release the used Qemu CPU

* by default to '-cpu Nehalem-v2'
* and to '-cpu EPYC' for SVM virtualization

With this change the build.conf file in the x86 build directory must be
re-generated by you, which otherwise may contain an older Qemu "-cpu " model,
which can collide with the new default Qemu CPU settings.
