

              ===============================================
              Release notes for the Genode OS Framework 23.05
              ===============================================

                               Genode Labs



; intro
; @nfeske


Goa tool updated to Sculpt OS 23.04, initial support for Rust
#############################################################

Last month, we released Sculpt OS 23.04 for PC and PinePhone. The new release
comes with various
[http://genodians.org/nfeske/2023-05-11-sculpt-os - usability improvements]
such as presets and on-target system updates.

; Screenshot(s) mobile UI

In particular, with Sculpt OS 23.04 running on the PinePhone, we have carved out
the base for hosting mobile apps on a Genode-based system. Yet, there are
only very few apps available right now. Since an OS is of no practical use
without apps, this urgently called for an SDK to simplify (mobile) app
development. After careful investigation, we opted for porting the
Ubuntu-Touch-UI toolkit to Genode and integrate it into Goa (Section
[Using Goa for bringing apps based on the Ubuntu-Touch-UI toolkit to Genode]),
our streamlined workflow tool for application development.
In addition, we integrated initial support for Rust's _cargo_ to make Goa
palatable to a broader developer audience (Section [Initial Rust support]).

The growing attention of the Goa tool prompted us to move it under the umbrella
of Genode Labs as we are increasing our development and maintenance efforts for
the tool. Aligned with the Sculpt release, the Goa tool has been updated with
the corresponding depot archive versions.
With this Genode release, we put a cherry on top and added bash completion to
improve the user experience even further. Having Goa installed, bash completion
is enabled by the following commands:

! goa update-goa master
! GOA_DIR=$(realpath $(which goa) | sed s#bin/goa##)
! echo "${GOA_DIR}/share/bash-completion/goa" >> ~/.bashrc

:Goa tool:

  [https://github.com/genodelabs/goa/]


Using Goa for bringing apps based on the Ubuntu-Touch-UI toolkit to Genode
==========================================================================

While writing a system clock, might be fun, it is not our fundamental
expertise. Therefore, we have looked into ways of supporting established
open-source SDKs for app development on Genode. We investigated two possible
options in depth, namely Ubuntu Touch's UI toolkit now called
[https://lomiri.com - Lomiri] and the
[https://docs.sailfishos.org/Tools/Sailfish_SDK - Sailfish SDK]. We have tried
to port applications for both stacks and after many iterations settled with the UI
toolkit. The full story can be read
[http://genodians.org/ssumpf/2023-05-06-ubunutu_ui - here]. Therefore, a port of
the Ubuntu UI toolkit is available on Genode right now and support for it has been
added to the Goa tool.

Writing an app for the PinePhone using the Goa tool should be a straight forward
experience:

* Since the UI toolkit depends on Qt5 add "genodelabs/api/qt5" to your
  _used_apis_ [http://genodians.org/nfeske/2019-11-25-goa - file]

* Add "ssumpf/pkg/ubuntu_ui_toolkit" to your _archives_
  [http://genodians.org/nfeske/2019-11-25-goa - file] to have the UI toolkit
  available within your package

* In order to have your QML code within your packet installed, add
  "<packet-name>.tar: install/" to your _artifacts_
  file [http://genodians.org/nfeske/2019-11-25-goa]

* Configure your _runtime_
  [http://genodians.org/nfeske/2019-12-19-goa-unix-terminal - file]

* Use
  ! goa run
  to execute your scenario on Linux for development

* Use
  ! goa build --arch arm_v8a
  in order to build for the PinePhone

* [http://genodians.org/nfeske/2020-01-16-goa-publish - Publish] your packet
  ! goa publish --depot-user john --depot-overwrite

Examples using QML, Qt5, and C++ can be found
[https://github.com/ssumpf/goa-projects - here]


Initial Rust support
====================

; @atopia




Uniform Wifi stack across PC and ARM platforms
##############################################

; @cnuke

commit 23cc96e661d2ef6b9b17bcfabad686598231c6f2
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Mar 2 18:22:45 2023 +0100

    wifi/pc: add firmware for the Intel AX210

commit 118fff04728d14a852b7f3b0ca03affdff28e844
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Mon Apr 3 11:37:45 2023 +0200

    iwlwifi: limit rx bufs to 2048
    
    Recent devices are configured with 4096 RX pages that lead to an
    increased memory usage. For the moment lower the amount to 2048
    and treat in potientially lower throughput for more conservative
    memory consumption.
    
    Fixes #4801.

commit 1041ed87734f08ab781f5a4c6e408a66b4d9bc31
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Apr 6 14:13:49 2023 +0200

    wifi: use latest available firmware
    
    This commit updates the used firmware images for the iwlwifi device
    to latest available ones (supported by the current 6.1.x driver).
    It also removes old firmware images that by now are not used anymore.
    
    Fixes #4807.

commit 56d366995c0737962a29e13becc0d4eb305d8c25
Author: Josef Söntgen <jws@sysret.de>
Date:   Wed Jan 11 17:16:36 2023 +0000

    wifi/pc: add ath9k driver
    
    The driver was only tested with an "Atheros AR9462 Rev:2" [168c:0034]
    device using the 'wifi.run' run script.
    
    Note: for it to work MSI may not be used as otherwise interrupts do not
    work. Using an IOMMU leads to the following fault:
    
    [ 0] IOMMU:0xffffffff817eb0b0 FRR:0 FR:0x22 BDF:4:0:0 FI:0xb0000000000000 (0)
    
    Issue #4813

commit 8ae5ae76fb7ff6bf2e4d62f38adf72b05ea661e1
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Wed Jan 25 14:53:00 2023 +0100

    wifi: support building for ARM64
    
    This commit introduces support for building the WLAN driver for ARM
    platforms. It makes the WPA supplicant and its support libraries
    available for all platforms. It also seperates the PCI parts to
    accommodate platforms where other bus protocols are used.
    
    Issue #4813

commit 0b08ae09c40fa0a50d50cb575b9a7e072877788c
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Tue Feb 28 14:33:14 2023 +0100

    wifi: check 'lx_get_mac_addr' before reporting
    
    The MAC address device report should be published once the device is
    available. Since this may happen at a later time we have to check the
    call.
    
    Issue #4813

commit eaaedb6ae892d90afcce57655742a79a48249cc3
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Mar 10 16:53:35 2023 +0100

    wifi: defer supplicant start-up
    
    The SDIO connected wireless device on the PinePhone is not available
    on start-up, which leads to the supplicant failing to initalize
    'wlan0'. Normally the supplicant would be used in a way that handling
    devices that appear at run-time happens gracefully.
    
    Rather than supporting this behavior we defer the start-up of the
    supplicant until the device could be openend successfully for now.
    
    Issue #4813

commit e6ee7d3d4ae9cca5c6c22dfd0f83a734ba37e40b
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Mar 10 16:53:01 2023 +0100

    wifi: provide platform specific DTB access
    
    The device-tree binary is normally required on ARM-based platforms
    where as on x86 it is omitted. The platform-specific DTB helper
    provides a generic interface for accssing the DTB and needs to be
    implemented on each platform.
    
    Issue #4813

commit 0b28c9ae6f506b1e7873b6b73b3447880a08130b
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Wed Apr 12 09:17:22 2023 +0200

    lib/vfs/wifi: remove dependency on wifi library
    
    The wifi VFS plugin is solely there to provide a hook for calling
    'Lx_kit::initialize()' prior to the static ctors. As the corresponding
    symbol can be resolved at run-time there is no need to add the
    library as a build-time dependency.
    
    Issue #4813

commit 6c36a58bb73731250508bee20bdc3fdbdf1bf468
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Wed Apr 12 13:37:17 2023 +0200

    lib/wifi: remove unused symbols from symbol.map
    
    Remove symboles that are no longer required.
    
    Issue #4813

commit 2b4246c59be466094789796d1adfdfaec69f3b44
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Wed Apr 12 13:39:38 2023 +0200

    lib/symbols/wifi: add symbols file for ABI so
    
    Add symbols file for the wifi shared-object.
    
    Issue #4813

commit 8f91f119b88cdce4915fedc81fe6163388179423
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Wed Apr 12 13:56:12 2023 +0200

    wifi: remove firmware library
    
    The library is merely an historical artifact and the raw archive is
    better used in its place.
    
    Issue #4813

commit 1d376717c1653c5ed455ee3a8bae975aa96e52b4
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Apr 13 15:26:00 2023 +0200

    net/netaddress: make copy member function const
    
    As the function does not alter the internal state of the
    object allow for using it in r/o contexts.
    
    Issue #4813


commit d81fbaa4d40d2eaf3a0a34b53bf8112b30ba41c4
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Mar 30 16:59:35 2023 +0200

    (allwinner) wifi/a64: add driver for rtl8723cs
    
    This commit adds a driver component for the PinePhone's RTL8723CS based
    WLAN device. It is port from Linux (orange-pi-5.14-20211103-1304) and
    behaves similar to the PC driver.
    
    Issue #17.


Base framework and OS-level infrastructure
##########################################

New tool chain based on GCC 12.3, C++20 enabled by default
==========================================================

; @cproc

commit f223191dfc5cb1076ee67661d03b59a58b786d44
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Mon Apr 3 14:21:01 2023 +0200

    binutils: update to version 2.40
    
    Issue #4827

commit 445398a7ddfeaa85b835cbde430f1c8d37843d37
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Mon May 8 10:18:46 2023 +0200

    gdb: update to version 13.1
    
    Issue #4827

commit b602b52f2986f13d2fdddec5e6af411aefaf9c35
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Wed Apr 26 18:30:01 2023 +0200

    tool_chain: update gprbuild to version 23.0.0
    
    Issue #4827

commit b6ed05df0c4f819b17a142c589faaf55bd457b52
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Tue May 9 12:08:32 2023 +0200

    gcc: update to version 12.3.0
    
    Issue #4827

commit 1c4f443e61b7b4cee4251e5620be0b025de23857
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Tue May 9 12:09:44 2023 +0200

    stdcxx: update to version 12.3.0
    
    Issue #4827

commit ce39c21383be2a0dbc18681a81a8eb5ddb388f64
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Tue May 9 12:10:12 2023 +0200

    gcov: update to version 12.3.0
    
    Issue #4827

commit c32ded99dcbb55becc3261d375283a03ee54ecda
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Tue May 9 12:10:41 2023 +0200

    sanitizer: update to version 12.3.0
    
    Issue #4827

commit 4c2a1c009a258670025cc19c535ad3b1353cbd62
Author: Christian Helmuth <christian.helmuth@genode-labs.com>
Date:   Mon May 15 14:29:26 2023 +0200

    Enable -std=gnu++20 by default
    
    Issue #4827

; Maybe highlight the typical build issues?
; (arithmetics with enums, incrementing volatile variables, ...)

commit 54462dff74ec1e872075236c4064f01ef3770cb5
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Sun May 21 08:24:24 2023 +0200

    binutils: support Genode lib name patterns with '-l' option
    
    Issue #4827


API changes
===========

As part of Genode's
[https://genode.org/documentation/release-notes/16.08#Cultivation_of_the_new_text-output_API - great API revision]
in 2016, we largely *abolished* the use of *format strings* throughout the
framework. This is desirable because a code base without format strings cannot
have format-string vulnerabilities. Still, a few occurrences, specifically the
interface for passing session-construction arguments, remained untouched since
then. With version 23.04 we finally wrap up the transition.

The revised 'Genode::Connection' accepts the session label, affinity,
and session-specific parameters as constructor arguments, whereas the
parameters are passed as a 'Genode::String'. This eliminates the need for
rendering a format string. Given this new interface, we were able to remove
format strings from all connection types, updated all components that
still happened to rely on format strings, and ultimately removed format
string from Genode's base API.

Format strings still play a role to accommodate 3rd-party code ported
to Genode. Whenever the 3rd-party code targets the C runtime, format
strings are readily available via the libc. For free-standing ports that
avoid the dependency from the full C runtime, e.g., ported device drivers,
a new 'format' library based on Genode's former _base/snprintf.h_ and
_base/console.h_ provides rudimentary format-string support.

As another matter of house keeping, we removed the _util/avl_string.h_
utility. The use case of organizing objects by using strings as keys is
covered by the _util/dictionary.h_ now.


Towards kernel-agnostic DMA protection
======================================

As sketched in our [https://genode.org/about/road-map - road map], we plan
having a feature-complete PC version of Sculpt OS based on base-hw by the end of
this year. One of the reasons why we are still sticking to base-nova for the PC
version is the fact that we are relying on NOVA's IOMMU support. One necessary
step to decouple Sculpt OS from base-nova is to integrated the IOMMU handling
into the platform driver.

Motivated by our
[https://genode.org/documentation/release-notes/23.02#Custom_IP_block_for_DMA_protection_on_AMD_Xilinx_Zynq - custom IP block for DMA protection on AMD/Xilinx Zynq],
we integrated the notion of IOMMU-like devices into the platform driver with
this release as a preparatory step. The platform driver automatically acquires
known IOMMU-like devices for itself by looking at the device types. Other
devices can then reference these devices by using '<io_mmu>' nodes. This is best
illustrated by looking at the devices ROM for the Zynq's dma_guard IP block:

! <devices>
!
!   <device type="dma_guard" name="dma_guard_0">
!     <!-- [...] -->
!   </device>
!
!   <device type="axi_dma" name="axi_dma_0">
!     <io_mmu name="dma_guard_0"/>
!     <!-- [...] -->
!   </device>
!
! </devices>

This tells the platform driver that, whenever a DMA buffer is allocated/freed
for the session owning the 'axi_dma_0' device, the 'dma_guard_0' must be
configured accordingly in order to allow/deny access to the corresponding memory
ranges. With the structural changes to the platform driver, the support for
dma_guard devices is simply added by implementing specific 'Io_mmu' and
'Io_mmu_factory' objects. You can find the code in the _dma_guard.h_ within
the
[https://github.com/genodelabs/genode-zynq/blob/master/src/drivers/platform/zynq/dma_guard.h - genode-zynq repo].

For the PC version of the platform driver, we implemented a _kernel_iommu_
device that still uses device PDs to pass IOMMU configuration to the NOVA kernel.
The _kernel_iommu_ is automatically instantiated and used as a default for each
device until we replaced this by a kernel-agnostic implementation in a future
release.

With these preparations, we paved the way for implementing configuration logic
for arbitrary IOMMU-like devices within the platform driver. In particular, the
platform driver has been made capable of managing multiple IOMMU-like devices
at the same time. However, there is one limitation that comes from the fact that
DMA buffers are not device-specific but allocated per session: All IOMMU-like
devices must either operate as MMU (virtual addressing) or as MPU
(physical addressing).


Revision of Genode's custom block-encryption infrastructure
===========================================================

Tresor library
~~~~~~~~~~~~~~

For about two years, our Ada/SPARK-based CBE block encryption and its GUI
front-end, the File Vault, served us well with rather manageable workloads
(like configuration and credential files) in x86 Sculpt. However, with the
rise of mobile Sculpt on the PinePhone, the CBE ecosystem faced a crisis.
At first, we realized that there was a list of requirements coming up with the
new target platform:

* Mobile platforms are usually less forgiving when it comes to performance and
  the CBE still exhibited a lot of potential for optimization.

* In mobile Sculpt, our block encryption will be an integral part of the base
  system (the "appliance role"), which marks a big step in the ongoing
  role shift from a mere experiment towards a central system component. With
  this role shift, however, maintainability becomes increasingly important.

* Now, that we decided to settle on this approach to block encryption and
  will increasingly expose it to real workloads, we can expect new requirements
  to pop up more frequently and with higher priority.

* And, last but not least, our SPARK/Ada runtime, so far, simply lacks ARM
  support.

This prospect forced us to carefully re-think our relation to the existing CBE
approach, and especially to the fact that it's core logic and crypto back-end
were entirely written in Ada/SPARK. When we started developing the CBE in
Ada/SPARK, we considered the possibility that the language could become popular
among the core developers of Genode and that, eventually, other, especially
critical parts of the framework could benefit from it as well. But this idea
didn't come true. Only a few of us came in touch with the new language and of
those even fewer acquired profound experience with it. As a consequence,
maintenance of the Ada/SPARK codebase that emerged with the CBE approach became
a bottle neck, effectively inhibiting growth of our block-encryption stack.

This fact in mind, and the above mentioned challenges in sight, we decided to
drop the CBE library and create a new implementation strongly inspired by the
CBE design but in C++, our "mother tongue". The new library is called Tresor,
brings the same feature set like the CBE and can also drive encrypted
containers that were created with the CBE. The File Vault has been adapted to
run with Tresor, so, File Vault users can continue using their containers as
usual without further ado. The entire Tresor-based ecosystem is
architecture-agnostic - the former restriction to x86 has been removed.

File Vault
~~~~~~~~~~

There are some new features to the File Vault. For instance, the component can
now be driven with one of two available user interfaces: The usual graphical
front-end via Menu View or the new text-based interface that receives commands
via configuration file and provides feedback through a report file. This allows
for the integration of the File Vault with automated controls respectively
lower- or higher-level UI's. The default remains the legacy interface, but one
can replace it with the text-based UI using the new "user_interface"
configuration flag (not re-configurable). A good example on how to use the
test-based UI is provided in the new "file_vault_cfg_report" run script.

Another, rather small but handy feature is that a File Vault can now be locked
and unlocked without having to restart the component. In the "locked" state,
all key material is removed from the cryptographic back-end and the driver for
the encrypted driver is shut down. The user is then prompted to provide the
correct credentials in order to re-accomplish access to the container.

Custom virtual machine monitor on ARM
=====================================

; @skalk

commit cb3b6c4b8859ea27df751f66074bb9e5b41da673
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Mon Mar 13 11:37:16 2023 +0100

    vmm: distinguish virtio interrupts
    
    VirtIO device models can assert interrupts to notify about
    buffer and configuration changes. By now, we could only assert
    buffer notification interrupts, but no configuration changes.
    The latter is needed, e.g. to notify about GPU mode changes.
    
    Ref genodelabs/genode#4783

commit 61454178c0d8f455207f9efaaaa6aa393e354dfe
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Mon Mar 13 11:52:51 2023 +0100

    vmm: support mode change in virtio gpu
    
    Fix genodelabs/genode#4783


NetBSD rump kernel on RISC-V
============================

With release 23.05 we have added RISC-V to our port of the
[https://wiki.netbsd.org/rumpkernel - rump kernel].
This enables RISC-V based devices to have file-system access on Genode.


Strengthened fault tolerance of on-target package management
============================================================

Genode's way of safely installing and deploying packages on-target - as introduced in
[https://genode.org/documentation/release-notes/18.02#On-target_package_installation_and_deployment - version 18.02] -
is a corner stone of Sculpt OS. The recent move of Sculpt OS to mobile devices,
however, revealed a couple of limitations that we addressed with the current
release.

First, in contrast to the PC version of Sculpt OS that allows for the
straight-forward management and editing of files using a regular command-line
interface, a touch-based user interface as present on the phone is far more
constrained. Problems that can be solved by manual intervention on the PC
without a second thought can become insurmountable showstoppers on the phone.
The most prominent problem is the recovery from the situation where package
dependencies remained incomplete due to an interruption of the installation
process or due to packaging mistakes. On the PC, the situation can be cleaned
up by simply clearing the depot using a single terminal command, followed by a
reinstall of the package. On the phone, the user was left out in the cold
with the message "package installed but incomplete" but with no obvious or
non-obvious way of recovery. The new version gracefully handles this failure
state by offering the retry of the package installation.

Second, network connectivity is far more fluctuating on mobile devices,
which increases the chance for download errors. The previous version that
regarded download errors as rare and sporadic issues, responded to such
errors by repeated and silent retrying. We found that a mobile phone demands
more graceful way to reflect such failure situations to the user, and to limit
the rate of futile download attempts. The new version preserves information
about download failures for user inspection and re-issues new downloads only
if not already flagged as unavailable.

Finally, we encountered the manual addition of software providers to the
system as a hurdle on the phone. On the PC, a new software provider can be
added by manually placing the provider's _download_ and _pubkey_ files the
local depot directory, which is straight-forward when using a shell. However,
on a touch-screen device, there is no obvious and simple way to supplement the
system with such information. To still accommodate the user's desire to
download and install software from arbitrary providers, we added the option to
explicitly skip the signature verification for downloads. This is useful in
scenarios where the lack of integrity of downloaded content does not pose a
risk, e.g., for untrusted applications that are rigidly sandboxed, or during
development.

Whenever the depot-download subsystem encounters the attribute 'verify="no"'
for an '<installation>' item, it accepts the installation even if no key is
available. It still applies verification for dependencies whenever possible.
E.g., if a package of the provider "jon" gets installed via 'verify="no"' and
the package depends on an archive by "genodelabs", for which the public key is
known, the integrity of the content originating from "genodelabs" is verified.


Libraries and applications
##########################

Qt5 reorg
=========

; @cproc

commit 80038ad936fdaa0a57cadf864f15c67ef4102a3f
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Wed Mar 15 09:12:19 2023 +0100

    qt5: split qt5 api
    
    Split api into 'qt5', 'qt5_qml', and 'qt5_webkit'. This makes it
    possible to link Qt5 apps more fine grained. Needed by Goa.
    
    fixes #4793

commit b7d1d8d09173eb6e136f22c323acc2f9e5ac1de4
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Fri Apr 21 15:27:22 2023 +0200

    qt5: create 'bin' directory in test run scripts
    
    Fixes #4822

commit 5080e88a7af6fd7cd9443f4edb401896bff2b217
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Fri Apr 21 15:27:45 2023 +0200

    qt5: split api recipes with Qt module granularity
    
    Fixes #4823

commit c9cb2b9de2d9a245623610bf193f760ca685c883
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Thu May 11 15:21:51 2023 +0200

    qt5: reduce external dependencies of host tools
    
    Fixes #4868

commit a15c6e0fd6c0e173b218e90d2ec0fd65d5c7f0e5
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Tue May 16 06:58:45 2023 +0200

    qt5: install host tools in /usr/local/genode/tool/23.05
    
    Issue #4868

commit b34cc1a698c71b43680691ffdc05f8fe11fba343
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Thu Mar 16 09:50:41 2023 +0100

    (world) qt5: split qt5 api
    
    Adjust to api split into 'qt5', 'qt5_qml', and 'qt5_webkit'.
    
    issue genodelabs/genode#4793


commit 9efcf284dfef11213a9cd39987bd8b09fae73931
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Thu Mar 16 15:22:40 2023 +0100

    (world) receipe: meta package for ubuntu-ui-toolkit
    
    This pulls in all dependencies for the Ubuntu UI toolkit, including a
    runtime with the required ROMs.
    
    fixes #318

commit 23ba08b885825fc5e7a3abd31c5f08abda4c2b43
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Fri Apr 21 20:27:38 2023 +0200

    (world) qt5: split api recipes with Qt module granularity
    
    Fixes #323


WireGuard improvements
======================

There are two smaller changes related to Genode's port of WireGuard. First,
peers can now be removed from WireGuard at runtime by removing the
corresponding <peer> tags from the component configuration. This operation
enforces the same assurances as removing a peer from a native WireGuard driver
in Linux.

The second change has to do with the nature of the port. The WireGuard port is
one of the rare examples where we use our Linux device driver environment
(dde_linux) for porting something that is not exactly a driver. The component
does not depend on a specific hardware configuration and therefore, the
emulated Linux kernel can be platform-agnostic. Consequently, while porting, we
created such a variant of the Linux emulation specifically for WireGuard.

However, we realized that this variant can come in handy for ports of other
hardware-agnostic kernel parts (for instance, lxip) as well. Therefore, we now
cut it out of the WireGuard port in order to make it a self-contained version
of the 'lx_emul' library. The new library is called 'virt_lx_emul' and is
accompanied by the 'virt_linux' target that can be used to build the
corresponding Linux kernel and run it in Qemu.

Updated or removed 3rd-party software
=====================================

VirtualBox updated to version 6.1.44
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

; @chelmuth

commit 37421a7879ff47b6c64f249f91a9352b4260ff72
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Thu Oct 27 09:25:07 2022 +0200

    vbox6: bump version from 6.1.26 to 6.1.44
    
    Fixes most of the GCC 12 problems.
    
    issue #4666

commit 7be915a185a442b14f66ccfe5715787a3758d659
Author: Christian Helmuth <christian.helmuth@genode-labs.com>
Date:   Wed Sep 21 09:28:19 2022 +0200

    vbox6: disable RDTSC exit
    
    For Windows guests, it's crucial to configure the paravirtualization
    provider in .vbox6 like follows. Otherwise, the TSC calibration fails
    (issue #4726) and the CPU frequency (in task manager) is bogus.
    
      <Paravirt provider="HyperV"/>
    
    Fixes #4726

commit 7e06aa13c17293eeb651d24610f3d99478a62dc5
Author: Christian Helmuth <christian.helmuth@genode-labs.com>
Date:   Thu Apr 20 15:41:31 2023 +0200

    vbox6: disable GSO in e1000 model
    
    Commit "vbox: avoid uncaught nic Empty_ack_queue exception" introduced a
    performance regression due to packet retransmission because of faulty
    GSO segment handling. As fixing the GSO handling is fairly complex, we
    disable GSO until a fix was developed.
    
    Issue #4820
    Issue #4821

commit a1eb94535d774322bb3b8a1176a231e9050c93f3
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Tue May 16 19:30:56 2023 +0200

    qemu-usb: support read/write of unused IO ranges
    
    The XHCI model reserves 0x4000 of IO memory but uses only 0x530.
    Implement read (0) and write (nop) for these regions as real hardware
    does.
    
    fixes #4902


Removed ports of pcre16 and icu libraries
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

; @cproc

commit 7fcd2f64db61ccdd31ad2e91b1cdeb6d535c13dd
Author: Christian Prochaska <christian.prochaska@genode-labs.com>
Date:   Fri May 19 06:27:39 2023 +0200

    libports: remove pcre16
    
    Fixes #4903

commit dffdc5817f4feef7f259ca6e80bebe8ff57c87e3
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Tue May 16 08:17:53 2023 +0200

    libport: remove icu library
    
    This was required by QtWebKit in the past, the QtWebEngine ships its own
    version. No other code depends on this. Revive if needed.
    
    fixes #4870


Device drivers
##############

Linux device driver environment updated to Linux 6.1.20
=======================================================

; @skalk

commit 2269f42e1757a031609b334707ef5aa9f5d1d388
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Mar 23 11:20:43 2023 +0100

    lx_emul: update Linux port to 6.1.20
    
    Fix genodelabs/genode#4798


Intel display driver
====================

; @alex-ab

commit e1533be6849b26ffab178c52afbbcad4a8a81751
Author: Alexander Boettcher <alexander.boettcher@genode-labs.com>
Date:   Fri Mar 24 16:01:48 2023 +0100

    intel/display: replace intel_fbdev with drm/kms
    
    Fixes #4806


USB
===

; @skalk

commit 3c45f5c7ab6e2c15e22dcaef05dbee0fc81edc49
Author: Christian Helmuth <christian.helmuth@genode-labs.com>
Date:   Thu Mar 23 16:45:12 2023 +0100

    usb: support 32 in-flight packets
    
    - move metadata specific to isochronous transfers from the descriptor
      into the content of USB-session packets
    - restore support for 32 in-flight packets in the USB C API
    
    Fixes #4749

commit bcc454aa8908e754f3d1e522b0ae4cfb193a481f
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Apr 27 11:37:53 2023 +0200

    drivers/usb_block: treat SYNC as barrier
    
    The commit implements the SYNC and TRIM as successful NOP, while
    the former is handled as an barrier to all other out-standing
    requests.
    
    Fixes #4825.

commit 19e2b5b8b2f1a3ec4c02a3904f875dbf0c2fabb5
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Apr 20 16:17:05 2023 +0200

    usb_net_drv: ensure freeing packets in destructor
    
    Ref genodelabs/genode#4795

commit f079d1f7c3a2087f96376cc42645a1808e8a79cb
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Apr 20 16:17:20 2023 +0200

    usb_hid_drv: ensure freeing packets in destructor
    
    Ref genodelabs/genode#4795

commit 97e3572844bd8aabf91f83be3f7fc96b2d06121f
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Tue Apr 18 11:51:41 2023 +0200

    lx_emul: use devio API for USB driver operations
    
    Fix genodelabs/genode#4795
commit 19e2b5b8b2f1a3ec4c02a3904f875dbf0c2fabb5
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Apr 20 16:17:05 2023 +0200

    usb_net_drv: ensure freeing packets in destructor
    
    Ref genodelabs/genode#4795

commit f079d1f7c3a2087f96376cc42645a1808e8a79cb
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Apr 20 16:17:20 2023 +0200

    usb_hid_drv: ensure freeing packets in destructor
    
    Ref genodelabs/genode#4795

commit 97e3572844bd8aabf91f83be3f7fc96b2d06121f
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Tue Apr 18 11:51:41 2023 +0200

    lx_emul: use devio API for USB driver operations
    
    Fix genodelabs/genode#4795

commit c4a723135752ab5b0531476574cf1f0652d305f5
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Wed May 3 17:23:25 2023 +0200

    (allwinner) a64_usb_host_drv: use devio API for USB
    
    Ref genodelabs/genode#4795

commit 5bdd80412cc84e4703d38582b98ad8336e29fedb
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Wed May 3 14:25:56 2023 +0200

    (imx) imx8mq_usb_host_drv: use devio API for USB
    
    Ref genodelabs/genode#4795


NVMe storage
============

; @cnuke

commit ae0e0c118ea07eca66022d8b2cca2d50594a62c3
Author: Josef Söntgen <jws@sysret.de>
Date:   Sun Nov 13 20:10:43 2022 +0000

    nvme_drv: add support for host-memory-buffer
    
    This commit introduces support for the HMB feature and will setup the
    buffer during start-up. The host-memory-buffer (HMB) feature is mostly
    used on NVMe devices that do not make use of an DRAM cache to store its
    translation tables amongst other operational data. Not using HMB can
    impair the performance on such devices.
    
    The memory is allocated in 2 MiB chunks of DMA-capable memory and its
    total size in bytes is configurable via the 'hmb_size' config attribute.
    The driver always checks the minimal and preferred size of the HMB and
    issues a warning in case it is not enabled via the configuration.
    Moreover, if the configured size is less than the minimal amount
    required by the device the HMB is not configured at all and a warning
    is issued also. If the configured size is more than the preferred size
    it will be capped to that amount.
    
    Fixes #4715.

commit 280724e6b5b68e32135b40632ff44c10581d6d3e
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Apr 28 17:38:10 2023 +0200

    nvme_drv: read proper FLBAS value
    
    Bit 0:3 indicate which of the (up to) 16 supported LBA formats is
    used for this namespace. Instead of only looking at those bits the
    driver looked at the complete 0:7 bits. Those, however, also include
    information on how metadata may be transferred. That leads to using
    the wrong index for reading the LBA format.
    
    Fixes #4832.


Audio-driver update
===================

; @cnuke

commit 1b552d594b6591874db83ba7236b65cb39dda0e2
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu May 4 14:25:34 2023 +0200

    dde_bsd: update audio driver to OpenBSD 7.3
    
    Fixes #4857.


Platforms
#########

Base-HW microkernel
===================

Principle x86 virtualization support (on Qemu)
----------------------------------------------

; @atopia

Boot-time RAM detection on the PinePhone
----------------------------------------

On the PinePhone we implemented dynamic detection of the system RAM size by
parsing the values of the DRAM controller as programmed by U-Boot. This way, 2
and 3 GB models of the PinePhone are supported by Genode.


Updated seL4 microkernel
========================

; @alex-ab


