

              ===============================================
              Release notes for the Genode OS Framework 25.11
              ===============================================

                               Genode Labs



; intro
; @nfeske


Genode-world using the Goa SDK
##############################

; @cnuke, @chelmuth

commit 114b23ff55f17f394921d1ecc775e61eece28193
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Thu Sep 18 14:43:22 2025 +0200

    Move existing content into legacy sub-directory
    
    This commit moves the already existing content of the _genode-world_
    repository into the _legacy_ sub-directory. Adjusting the currently
    checked-out repository is necessary to prevent the interruption of
    the development process.
    
    Please look at the updated _README_ file for further information.
    
    Issue #412.

commit 3e415afacd94f2b0db7701d56236f2495938d45c
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Sep 19 12:51:21 2025 +0200

    Adapt README to the new shape of the repository
    
    Issue #412.

commit e391bd7087df2a56e4d1c8d794bbf93bfe89f59f
Author: Josef Söntgen <josef.soentgen@genode-labs.com>
Date:   Fri Oct 24 16:58:18 2025 +0200

    Set wildcard user for projects within world
    
    Issue #412.


Enhanced Goa SDK
================

The updated Goa SDK comes with a series of enhancements eliminating a few
points of friction such as the automated tool-chain installation for Rust,
the two-stage build process for Meson projects with executable and library
targets, and the augmented resolution of version information:

Goa always supported re-using other users' depot archives such as ported
libraries. However, determining what version to use has never been properly
addressed apart from a built-in curated list of archives from _genodelabs_. We
therefore equipped Goa with the ability to publish a depot index that contains
the versions not only of pkg archives but also of src and api archives. This
enables users to record and publish certain versions of their ported libraries
or re-usable components. Vice versa, Goa will automatically look up this version
information from a user's depot index if necessary. In addition to version
information, using archives of other users often requires having a look into
their documentation. This is addressed by the new 'info' command that nicely
displays the _README_ file from a selected depot archive.

Further enhancements are aligned to the genode-world use case: We added the
notion of a wildcard depot user to allow different users to publish the same
Goa project in their depot. Moreover, the new 'exported' and 'published'
commands provide assistance in determining whether the exported/published
archives are up-to-date with the project's state. For convenience, we
added a '--if-needed' option to the 'bump-version' command. When provided,
Goa omits bumping a project's version if the exported archive is already
up-to-date.

Internally, we entirely overhauled the parsing of configuration files in Goa
in order to untie it from XML and give way to the new human-oriented
configuration format.

To round things of, we have integrated support for library-based
performance profiling leveraging GCC's '-finstrument-functions'. For more
details on this and the aforementioned changes, please refer to the
corresponding article on genodians.org.

:Genodians article "What's new in Goa 25.10":

  [https://genodians.org/jschlatow/2025-11-03-goa-25-10]


Base framework and OS-level infrastructure
##########################################

Human-inclined data (HID) processing
====================================

With [https://genode.org/documentation/release-notes/25.08#Consideration_of_a_lean_alternative_to_XML - Genode 25.08],
we started the practical exploration of a new syntax for configurations and
state reports. The recent Sculpt OS release 25.10 was accompanied with a
flavor that uses the new format by default and allows us to experience all
of our use cases live on daily use.

:Genodians article "Sculpting with less noise and more clarity":

  [https://genodians.org/nfeske/2025-10-30-sculpt-human]

To make this possible, all components relevant for Sculpt OS have been
relieved from their formerly hardwired dependency from XML by using the
'Genode::Node' API.

While practically using and discussing the new format, we quickly found its
original working title (human-readable data - HRD) a little bit unpleasant.
So HRD has been renamed to HID, which stands for human-inclined data.

The benefit of the new format becomes most striking when information lends
itself to be presented in tabular form. For example, a list of Wifi
accesspoints with their respective properties, or a table of session-routing
rules. To ease the output of such tabular data, the 'Generator' API has been
extended with a new 'tabular' method. It instructs the HID generator to format
the contained nodes in tabular way. Two forms are supported: In the presence
of nested nodes, the nodes appear as table columns and attributes appear
densely. With only one node level, attributes are formatted as a table.
Trailing optional attributes are displayed densely.


API curation
============

The 'Thread' API still maintained compatibility to old interfaces we declared
as deprecated already in 2016 when we fully embraced dependency injection and
went on our mission to remove component-global side effects from the API.
Until now, however, some of those old interfaces where relied on by the
framework itself. Those parts have now been reworked, using 'Genode::Runtime'
as token for invoking global side effects, like the interplay with the stack
area. Thanks to these changes, the deprecated Thread constructors could now
be removed.

This change has ripple effects towards all places where 'Thread' objects are
manually constructed, e.g., 'Rpc_entrypoint'. Since all users had to be
adapted anyway, we took the opportunity of removing basic types as constructor
arguments to foster API safety.


Automatic component restart upon stopped heartbeat
==================================================

Genode's existing
[https://genode.org/documentation/genode-foundations/25.05/system_configuration/The_init_component.html#Component_health_monitoring - heartbeat-monitoring mechanism]
reflects the condition of a non-responding component in init's state report,
which can be evaluated by a management component to take a deliberate policy
decision. The usual response is the restart of the child by increasing the
child's version attribute. Since this policy has become so proliferated,
however, it is sensible to support it directly in init, eliminating the need
for a separate management component.

The new mechanism can be enabled in the configuration of the init component by
setting the 'restart_after_skipped' attribute of the child's 'heartbeat' node
to a value greater than 0. This way, the maximum rate of restarts can be
controlled per child.

Thanks to this feature, the self-healing abilities of Sculpt OS are no longer
limited to components managed by the system but can now be leveraged for
user-deployed components and launchers. For example, the touchpad driver,
which knowingly fails once every dozen boots on some laptops, is now
automatically restarted when it got stuck, making the touchpad ultimately
available upon the second try, just a few seconds later.


TCP/IP improvements
===================

; @ssumpf

commit 3cee815f718a5e492a85d4df442f7d2507478b1e
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Mon Sep 22 08:36:05 2025 +0200

    lxip: enable KEEPALIVE/REUSEADDR
    
    issue #5706

commit 28ddde729ec2c4e552fd3909a1c4d334cc7405dc
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Sun Sep 28 21:32:55 2025 +0200

    lwip: add support for sockopts
    
    * KEEPALIVE/REUSEADDR
    * set so_error according to error returned by lwip (preparation for
      SO_ERROR)
    
    issue #5706

commit d7e5331486e153a8e89562f0f44d82e738ab7056
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Wed Sep 24 09:27:26 2025 +0200

    vfs/ip: add sockopt-file system
    
    * add Single_file_system based sockopt files in directory-file system
      'sockopts'
    * remove port checks because overlapping is handled by the IP-stacks now
    
    issue #5706

commit 07e4351aaca5be3d9ead071ac909991218ae7a4e
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Thu Sep 25 19:16:24 2025 +0200

    libc: socket_fs_plugin support more sockopts
    
    Add support for KEEPALIVE/REUSEADDR
    
    issue #5706

commit 40c5b333158dd5cbf5984ddda7f80f1888267336
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Wed Sep 24 22:18:42 2025 +0200

    run/sockopt_libc: libc based sockopt test
    
    * test sockopts
    * no network required
    
    fixes #5706


Memory-capped log aggregation
=============================

Sculpt's report file system is an in-memory file system with a statically
defined RAM quota of 16 MiB. Besides aggregating reports of various components
(in particular device drivers), it hosts the _/report/log_ file, which gathers
the diagnostic output of all components. During normal use, the log file is in
the order of 100 KiB. However, in the presence of a rampaging component that
prints messages in an infinite loop, the report file system can eventually
fill up. To counter such situations, we introduced a new VFS plugin.

The new 'ram_log' VFS plugin stores up to a limited number of bytes of an
append-only file in RAM. Should the content written to the file exceed the
configured limit, the oldest content is replaced by zeros, making room for the
most recent logged information in memory. The file still appears growing in
size but only the most recent data remains present. In Sculpt 25.10 the log
is now capped at 1 MiB, effectively protecting the report file system from
exhaustion.

Vaguely related while speaking of Sculpt OS, the 'terminal_log' component has
been changed to prefix each line with a timestamp in seconds, showing one
digit after the comma. Note that this change makes the component depend on
a timer service now.


Simplified configuration of POSIX components
============================================

Tag-value argument pairs of traditional POSIX applications are technically two
distinct arguments, appearing as two consecutive elements in the 'argv' array.
Hence, such pairs have to appear as separate arg nodes in the configuration, e.g.:

! <arg>-geometry</arg> <arg>1024x768</arg>

or in HID syntax:

! + arg | : -geometry
! + arg | : 1024x768

This appears not only as wasteful but also does not convey well that both arg
nodes belong together. We now added the ability to define a pair of 'argv'
elements using a single 'arg' node. By combining an optional 'name' attribute
with quoted content, tag-value arguments can now nicely be expressed as one
arg node:

! <arg name="-geometry">1024x768</arg>

or respectively in HID syntax:

! + arg -geometry | : 1024x768


Streamlined on-target test suite
================================

The depot-autopilot component orchestrates the execution of the framework's
comprehensive test suite on a test target, using Genode's package management.
Each test has the form of a package with its _runtime_ definition augmented
with the success criterion of the test. The depot-autopilot deploys each test
after another, detect successes or failures, and collects the results. The
test suite is currently comprised of around 80 packages.

Even though the depot-autopilot serves us well since
[https://genode.org/documentation/release-notes/18.11#Automated_test_infrastructure_hosted_on_top_of_Genode - introduced in 2018],
code-wise, it has largely remained at its initial stage with a fair share of
ad-hoc decisions.
Our recent move to the
[https://genode.org/documentation/release-notes/25.08#Syntax-agnostic_configuration_and_reporting - syntax-agnostic]
'Genode::Node' API ultimately prompted us to rewrite the depot-autopilot
orchestrator and to streamline the suite of tests.

* A test's success criterion is now consistently expressed in the form of
  'succeed' or 'fail' nodes. The long deprecated 'events' declarations are no
  longer supported.

* The support for the 'log_prefix' attribute in 'fail' and 'succeed' nodes
  has been dropped as it has remained unused.

* Time values are now printed with two digits after the comma because
  the milliseconds digit is never inspected in practice.

* The formerly hard-coded '[init]' prefix of each test's log output,
  regardless of whether init was actually being used or not, has been
  removed.

* The meaning of log patters have been slightly tightened:
  The previous version accepted a match of a pattern line against any part
  of a log line. The new version accepts a match only if the pattern line
  matches the log line from the beginning of the line. The previous
  matching semantics can be achieved by starting a pattern line with the
  wildcard '*'.

* Exit codes can now be used as success criterion by specifying an 'exit'
  attribute to 'succeed' and 'fail' nodes. If a 'succeed' node features both
  an exit code and a log pattern, both conditions must be satisfied.

  This feature alleviates the need to wrap a test in an init instance for the
  mere matching of the "child ... has exited ..." message, which was a pattern
  found in about 25% of the test packages. Those tests now benefit from
  simpler runtime definitions and shorter log output.

  Whenever a test completes due to its exit code, the summary report marks the
  test as 'exit'.

* The depot_autopilot.run script changes the LOG label for test output from
  "init -> depot_autopilot" to "init -> test" to reduce the likelihood for
  line breaks.

* The duration of the entire test suite has been reduced by one third,
  mostly due to the tightening of the parameters of time-driven tests.


Device drivers
##############

; @chelmuth

USB-to-serial adapters
======================

commit 3022954f80be1d0c256a4b5a8d9d2f4694d8f345
Author: Christian Helmuth <christian.helmuth@genode-labs.com>
Date:   Fri Sep 5 14:55:42 2025 +0200

    Support USB-to-serial adapters
    
    Included drivers:
    
      Prolific 2303 Single Port (PL2303)
      FTDI Single Port (FT232, FT245)
      Winchiphead CH341 Single Port
      CP210x UART Bridge
    
    Tested devices:
    
      067b:2303  PL2303
      0557:2008  PL2303
      0403:6001  FT232
    
    See usb_serial.run usb_serial_bash.run for integration examples.
    
    Issue #5686

Improved Intel GPU support
==========================

; @ssumpf

commit 6b19a30daaff4815e543dd4620162c8e312dfc29
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Mon Nov 17 08:52:39 2025 +0100

    gpu/intel: enable Alder Lake GPUs
    
    This commit enables basic Alder Lake-GPU support (device id: 0x46a6).
    There are no optimization in place.
    
    issue #5742

commit 6e9965e64a46d4a33b1192d1d71d68a383e8aa8d
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Tue Nov 18 11:45:39 2025 +0100

    libdrm: add vtable to Gpu::Vram
    
    Commit "libdrm: move Gpu::Vram into separate namespace"
    (db02e04d0c5465579a3d7d66dac17f2fc5ca830a) lead to an implementation
    where both, lima and etnaviv, inherit from an empty Gpu::Vram class.
    This causes the problem that the ID-space in both implementations is of
    type Gpu::Vram, leading to the respective destructors (Lima::~Vram,
    Etnaviv::~Vram) not being called upon destruction, and thus, not freeing
    GPU memory.
    
    Featured in this commit:
    
    * move the Gpu::Vram definition into separate header which is used by
      entaviv/lima
    
    * add virtual destructor to Gpu::Vram
    
    issue #5748

commit 1f1bc09ea9c6e92006a811860ea0c935ffd49a8e
Author: Sebastian Sumpf <sebastian.sumpf@genode-labs.com>
Date:   Tue Nov 4 14:35:02 2025 +0100

    mesa/iris: make bo-cache configurable
    
    The buffer-object cache requires quite some memory overhead but also
    brings a lot of performance in low-latency benchmarks like glMark2. With
    this commit we make the cache configurable trough the IRIS_USE_BO_CACHE
    environment variable (default is true).
    
    issue #5748


Platforms
#########

Execution on bare hardware (base-hw)
====================================

; @skalk

commit b5c19addc5874b2c7b330c964faae757f8549897
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Wed Sep 10 14:23:40 2025 +0200

    hw: account for ressources of page-tables
    
    Add another page-table allocator that is able to dynamically extend
    its memory, and thereby uses core's mapped memory that gets accounted
    to the corresponding pd-session, or vm-session.
    
    The static page-allocator variant is kept for core's page-table, and
    bootstrap.
    
    Fix #5645

commit cfc7a9b9eb3ec99612bd517502fb1771f2409c98
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Sep 4 16:44:51 2025 +0200

    hw: use typed return and id-values in syscalls
    
    * Introduce enum class definitions for syscall IDs
    * Introduce specific return types per syscall with result
    * Eliminate result values, which were never evalulated
    * Distinguish architecture-specific register access from
      system-call argument mapping
    * Evalulate all arguments and return values inside the top-level
      Kernel::Thread::_call member function, only use typed values
      in all sub-functions
    * Name kernel-internal sub-functions for system-call execution
      in a unified fashion like: _call_[kobject]_[function],
      whereby kobject means something like: thread, pd, irq, vcpu,
      or signal, and function can be things like: pause, create, destroy,
      and so on
    
    Fix #5384

commit ff8eda28988a34e128b704fc1f401426cd38d18e
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Fri Jun 13 15:01:31 2025 +0200

    base-hw: map cpu-priorities to scheduling-groups
    
    Implement heuristic that matches the intention of Sculpt OS with
    two init-levels: top-level static init with two prioritiy levels,
    and dynamic runtime-init with up to eight priority levels.
    
    Ref #5117
    Ref #5605

commit dcce5c2efa99230423233761efd17ed933d3a489
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Wed Oct 22 18:12:43 2025 +0200

    hw: consistently differentiate local and global IC
    
    This patch tries to cleanup the architectural inconsistencies of interrupt
    controller implementations by:
    
    * Consistently differentiate in between Board::Local_interrupt_controller and
      Board::Global_interrupt_controller within kernel and bootstrap
    * The name Board::Pic is thereby replaced by Board::Local_interrupt_controller
    * Move the global parts of ARM's GICv2 and GICv3 to the corresponding
      Board::Global_interrupt_controller classes, replacing dummy ones
    * The maximum number of all (including shared) interrupts is part of the
      Global_interrupt_controller now
    * In bootstrap on platforms where IC initialization is crucial,
      initialize Global_interrupt_controller and Local_interrupt_controller
      at the same scope to enhance readability
    
    Implicitly, this commit removes a regression on ARMv8a boards with GICv2,
    like the Pinephone that was brought in by:
    
    Issue #5640
    Fix #5722

commit f438d3ed145c79f14e3f8dd52182322f466385bb
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Nov 13 13:31:05 2025 +0100

    hw: use X2APIC instead of LAPIC if possible on x86
    
    This commit introduces the X2APIC implementation in base-hw. To be able
    to keep the register definitions and usage in the class, this commit
    introduces a local "Mmio" access utility used by the underlying
    Genode::Mmio template, which uses the correct way to access the APIC,
    either by MSR or MMIO access.
    
    Ref #5752

commit f13f65eec265b2cc449fbff4c50071c033e757c4
Author: Stefan Kalkowski <stefan.kalkowski@genode-labs.com>
Date:   Thu Nov 20 16:09:20 2025 +0100

    hw: enable ACPI X2APIC detection
    
    This commit extends the bootstrap ACPI code to detect X2APIC
    local-cpu interrup controller interfaces, and retrieve the
    APIC IDs of the different cpu cores.
    The current implementation is limited to APIC IDs beneath 0x100.
    If the hardware provides bigger IDs, the boot-process will fail.
    
    Fix #5752


seL4 kernel
===========

; @alex-ab

commit 9ef3271d14fed2e37a9bddc9209845a91ed62c15
Author: Alexander Boettcher <alexander.boettcher@genode-labs.com>
Date:   Mon Sep 1 11:50:11 2025 +0200

    sel4: adjust kernel config for ARM 32bit
    
    With the seL4 13 Update the sed tool could not apply the config parameter
    adjustments, since the pattern it was looking for changed slightly.
    
    Issue #5581

commit e8d9e45cf3cf932fcd70a3eab4cd8af474d7d589
Author: Alexander Boettcher <alexander.boettcher@genode-labs.com>
Date:   Mon Jun 9 21:46:57 2025 +0200

    sel4: add principal armv8 support
    
    Enable support for imx8mq_evk and virt_qemu_arm_v8
    
    The sel4_tools got updated to an compatible version to run with ARMv8 seL4 13.0
    
    Fixes #5746


Build system and tooling
########################

; @nfeske

commit 5a900cd3ea898d95e2b628686e5765f6cdf2f064
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Mon Sep 29 16:21:34 2025 +0200

    tool/hrd: add -i for changing hrd file in place
    
    Fixes #5698

commit 2e493ea4c6b9d926a583596df2a7219a701222ff
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Fri Oct 24 14:33:52 2025 +0200

    tool/hrd: don't decorate top-level attribute lines
    
    Skip the leading '|' for the top-level node because the pipe does
    not continue below the first sub node, which looks inconsistently.

commit ca549ed2704a607711f5ae385d3595823a6f97ae
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Sat Oct 25 12:33:09 2025 +0200

    tool/run: accept both XML and HRD
    
    Issue #5710

commit 55824c04c3285b9f478f62065327094c58cc4e3d
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Fri Nov 7 22:35:08 2025 +0100

    tool/hrd: preserve formatting when filtering
    
    Let the parser capture the existing formatting by recording the
    whitespace sequence ("prespace") preceeding the actual content. Such
    prespace may contain spaces, newlines, and pipe characters. This
    information is used to largely preserve the formatting during the set,
    disable, enable, and remove commands.
    
    Fixes #5737

commit 9457bc6ec91e570a5e35484e136b9dd2730f697d
Author: Norman Feske <norman.feske@genode-labs.com>
Date:   Tue Nov 18 17:14:51 2025 +0100

    test.run: remove dependency from XML
    
    This patch replaces the use of xmllint by tool/hrd, thereby allowing
    pkg/runtime files to be formatted as either XML or HRD.
    
    Issue #5745

